# 头像检测工具介绍文档

## 概述

本文档介绍了“头像检测”HTML 页面的功能和技术实现。该页面是一个实用工具，允许用户输入邮箱地址，并选择一个头像托管服务商（如 Cravatar、Gravatar、WeAvatar、Libravatar）以及期望的头像尺寸，然后系统会检测该邮箱地址是否在所选服务商处设置了头像，并显示相关信息和头像预览。

该工具旨在方便用户快速检查和获取不同服务商提供的头像链接，特别适用于开发者或需要集成头像功能的用户。

## 主要功能

1.  **邮箱输入**: 用户可以输入一个完整的电子邮箱地址。
2.  **头像服务商选择**:
    * 用户可以从下拉列表中选择一个头像服务商，目前支持：
        * Cravatar
        * Gravatar
        * WeAvatar
        * Libravatar
3.  **头像尺寸选择**:
    * 用户可以从下拉列表中选择期望的头像尺寸，选项包括：40px, 80px, 120px, 200px。
4.  **信息展示**:
    * **邮箱哈希值**: 显示输入邮箱经过 MD5 哈希处理后的值。
    * **完整 URL**: 显示根据所选服务商、邮箱哈希和尺寸生成的完整头像 URL。
5.  **一键复制**:
    * 提供“复制 Hash”按钮，方便用户复制邮箱的 MD5 哈希值。
    * 提供“复制 URL”按钮，方便用户复制生成的完整头像 URL。
6.  **头像预览**:
    * 如果检测到头像可用，将在页面上直接显示该头像的预览图。
7.  **状态提示**:
    * 通过动态消息区域向用户反馈操作结果，例如：
        * 成功找到头像。
        * 未找到头像或服务不可用。
        * 输入格式错误。
        * 加载超时。
8.  **响应式设计**:
    * 页面布局能够自适应不同屏幕尺寸（桌面、平板、移动设备），确保在各种设备上都有良好的用户体验。
9.  **服务商链接**:
    * 页脚列出了各个支持的头像服务商的官方网站链接，方便用户了解更多信息。

## 技术栈

* **HTML**: 用于构建页面基本结构。
* **CSS**: 用于页面样式设计和响应式布局。
    * 使用了现代 CSS 属性，如 Flexbox 进行布局。
    * 通过媒体查询 (`@media`) 实现响应式设计。
* **JavaScript**: 用于实现页面的核心逻辑和交互功能。
    * **jQuery**: 简化 DOM 操作和事件处理。
    * **blueimp-md5**: 用于计算邮箱地址的 MD5 哈希值。
* **外部库**:
    * jQuery (via `s4.zstatic.net`)
    * blueimp-md5 (via `s4.zstatic.net`)

## 工作流程

1.  **用户输入**: 用户在输入框中填写邮箱地址，并选择头像尺寸和头像服务商。
2.  **输入验证**: 点击“检查头像”按钮后，JavaScript 首先验证邮箱地址是否为空以及格式是否正确。
3.  **哈希计算**: 如果输入有效，将邮箱地址转换为小写，并使用 MD5 算法计算其哈希值。
4.  **URL 构建**:
    * 根据用户选择的服务商，脚本会查找预定义的 `serviceProviders` 数组，获取服务商的基础 URL。
    * 然后，将基础 URL、邮箱哈希值和选择的尺寸参数拼接成完整的头像请求 URL。特别地，Libravatar 使用 `size` 参数，而其他服务商通常使用 `s` 参数。
    * URL 中包含 `d=404` 参数，表示如果找不到头像，服务商应返回 404 错误。
5.  **头像请求与处理**:
    * 创建一个新的 `Image` 对象，并将其 `src` 属性设置为构建好的头像 URL。
    * 设置一个超时计时器（8秒），以处理加载缓慢或服务不可用的情况。
    * **加载成功 (`img.onload`)**: 如果图片成功加载，清除超时计时器，在页面上显示头像预览，并提示用户头像已设置。
    * **加载失败 (`img.onerror`) 或超时**: 如果图片加载失败（例如返回 404）或超时，清除超时计时器（如果适用），并提示用户未设置头像或服务不可用。
6.  **结果展示**: 邮箱哈希值和完整的头像 URL 会显示在页面上，相应的复制按钮也会被激活。
7.  **清空与重置**: 如果用户清空邮箱输入框，相关的结果（哈希、URL、头像预览、状态消息）会被重置。

## 注意事项

* 代码中包含了一个免责声明，提示用户 Gravatar 服务在中国大陆可能不可用，预览可能会异常。
* 在 `window.onload` 事件中，会检查 jQuery 和 MD5 库是否成功加载，如果失败则会显示错误信息。
* 复制功能优先使用 `navigator.clipboard` API，如果浏览器不支持，则回退到使用 `document.execCommand('copy')` 的传统方法。

这个头像检测工具提供了一个简洁易用的界面，帮助用户快速验证和获取各种头像服务上的头像信息。
